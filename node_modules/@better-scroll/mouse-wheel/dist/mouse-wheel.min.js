!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).MouseWheel=t()}(this,function(){"use strict";var o="undefined"!=typeof window,e=o&&navigator.userAgent.toLowerCase();e&&/wechatdevtools/.test(e),e&&e.indexOf("android");function a(e,t,o){return e<t?t:o<e?o:e}var r=o&&document.createElement("div").style,t=function(){if(!o)return!1;var e={webkit:"webkitTransform",Moz:"MozTransform",O:"OTransform",ms:"msTransform",standard:"transform"};for(var t in e)if(void 0!==r[e[t]])return t;return!1}();function n(e){return!1===t?e:"standard"===t?"transitionEnd"===e?"transitionend":e:t+e.charAt(0).toUpperCase()+e.substr(1)}function i(e,t,o,r){e.addEventListener(t,o,{passive:!1,capture:!!r})}function s(e,t,o,r){e.removeEventListener(t,o,{capture:!!r})}t&&"standard"!==t&&t.toLowerCase();var l=n("transform"),h=n("transition");o&&n("perspective"),n("transitionTimingFunction"),n("transitionDuration"),n("transitionDelay"),n("transformOrigin"),n("transitionEnd");var c=o&&window;function u(){}o&&(c.requestAnimationFrame||c.webkitRequestAnimationFrame||c.mozRequestAnimationFrame||c.oRequestAnimationFrame),o&&(c.cancelAnimationFrame||c.webkitCancelAnimationFrame||c.mozCancelAnimationFrame||c.oCancelAnimationFrame);var d=(m.prototype.destroy=function(){this.removeDOMEvents(),this.events=[]},m.prototype.addDOMEvents=function(){this.handleDOMEvents(i)},m.prototype.removeDOMEvents=function(){this.handleDOMEvents(s)},m.prototype.handleDOMEvents=function(t){var o=this,r=this.wrapper;this.events.forEach(function(e){t(r,e.name,o,!!e.capture)})},m.prototype.handleEvent=function(t){var o=t.type;this.events.some(function(e){return e.name===o&&(e.handler(t),!0)})},m);function m(e,t){this.wrapper=e,this.events=t,this.addDOMEvents()}function p(e){this.scroll=e,this.wheelStart=!1,e.registerType(["mousewheelMove","mousewheelStart","mousewheelEnd"]),this.mouseWheelOpt=e.options.mouseWheel,this.deltaCache=[],this.registorEvent(),this.hooksFn=[],this.registorHooks(e.hooks,"destroy",this.destroy)}return p.prototype.destroy=function(){this.eventRegistor.destroy(),window.clearTimeout(this.wheelEndTimer),window.clearTimeout(this.wheelMoveTimer),this.hooksFn.forEach(function(e){var t=e[0],o=e[1],r=e[2];t.off(o,r)})},p.prototype.registorEvent=function(){this.eventRegistor=new d(this.scroll.scroller.wrapper,[{name:"wheel",handler:this.wheelHandler.bind(this)},{name:"mousewheel",handler:this.wheelHandler.bind(this)},{name:"DOMMouseScroll",handler:this.wheelHandler.bind(this)}])},p.prototype.wheelHandler=function(e){this.beforeHandler(e),this.wheelStart||(this.wheelStartHandler(e),this.wheelStart=!0);var t=this.getWheelDelta(e);this.wheelMove(t),this.wheelStopDetactor(e,t)},p.prototype.wheelStartHandler=function(e){this.deltaCache=[],this.scroll.trigger(this.scroll.eventTypes.mousewheelStart)},p.prototype.wheelStopDetactor=function(e,t){var o=this;window.clearTimeout(this.wheelEndTimer);var r=this.mouseWheelOpt.throttle||400;this.wheelEndTimer=window.setTimeout(function(){o.wheelStart=!1,window.clearTimeout(o.wheelMoveTimer),o.wheelMoveTimer=0,o.scroll.trigger(o.scroll.eventTypes.mousewheelEnd,t)},r)},p.prototype.getWheelDelta=function(e){var t=this.mouseWheelOpt,o=t.speed,r=void 0===o?20:o,n=t.invert,i=0,s=0,l=void 0!==n&&n?-1:1;switch(!0){case"deltaX"in e:s=1===e.deltaMode?(i=-e.deltaX*r,-e.deltaY*r):(i=-e.deltaX,-e.deltaY);break;case"wheelDeltaX"in e:i=e.wheelDeltaX/120*r,s=e.wheelDeltaY/120*r;break;case"wheelDelta"in e:i=s=e.wheelDelta/120*r;break;case"detail"in e:i=s=-e.detail/3*r}return i*=l,s*=l,this.scroll.scroller.scrollBehaviorY.hasScroll||(i=s,s=0),this.scroll.scroller.scrollBehaviorX.hasScroll||(i=0),{x:i,y:s,directionX:0<i?-1:i<0?1:0,directionY:0<s?-1:s<0?1:0}},p.prototype.beforeHandler=function(e){var t=this.scroll.options,o=t.preventDefault,r=t.stopPropagation,n=t.preventDefaultException;o&&!function(e,t){for(var o in t)if(t[o].test(e[o]))return!0;return!1}(e.target,n)&&e.preventDefault(),r&&e.stopPropagation()},p.prototype.wheelMove=function(e){var t=this;if(this.mouseWheelOpt.debounce&&this.wheelMoveTimer)this.deltaCache.push(e);else{var o=this.deltaCache.reduce(function(e,t){return{x:e.x+t.x,y:e.y+t.y}},{x:0,y:0});this.deltaCache=[];var r=this.scroll.x+Math.round(e.x)+o.x,n=this.scroll.y+Math.round(e.y)+o.y,i=this.scroll.scroller.scrollBehaviorX,s=this.scroll.scroller.scrollBehaviorY;if(r=a(r,i.maxScrollPos,i.minScrollPos),n=a(n,s.maxScrollPos,s.minScrollPos),!this.scroll.trigger(this.scroll.eventTypes.mousewheelMove,{x:r,y:n})){var l=this.getEaseTime();r===this.scroll.x&&n===this.scroll.y||this.scroll.scrollTo(r,n,l)}this.mouseWheelOpt.debounce&&(this.wheelMoveTimer=window.setTimeout(function(){t.wheelMoveTimer=0},this.mouseWheelOpt.debounce))}},p.prototype.registorHooks=function(e,t,o){e.on(t,o,this),this.hooksFn.push([e,t,o])},p.prototype.getEaseTime=function(){var e=this.mouseWheelOpt.easeTime||300;return e<100&&function(e){console.error("[BScroll warn]: "+e)}("easeTime should be greater than 100.\n      If mouseWheel easeTime is too small, scrollEnd will be triggered many times."),e},p.pluginName="mouseWheel",p.applyOrder="pre",p});
